---
layout: post
title:  "Setup WordPress"
date:   2025-11-04 21:44:56 +0700
categories: wordpress
---
OS: Kali Linux

Download the WordPress zip from https://vi.wordpress.org/download/ and extract it.

At the same level as the `/wordpress` folder, create the Docker Compose files and the WordPress files.

Folder layout (example):

```
docker-compose.yml
/wordpress:
  /wp-admin
  wp-config.php
  ...
```

docker-compose.yml

```yaml
version: '3.8'

services:
  db:
    image: mysql:5.7
    restart: always
    environment:
      MYSQL_DATABASE: wordpress
      MYSQL_USER: wpuser
      MYSQL_PASSWORD: wppass
      MYSQL_ROOT_PASSWORD: root
    volumes:
      - db_data:/var/lib/mysql
    healthcheck:  
      test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]
      timeout: 20s
      retries: 10

  wordpress:
    image: wordpress:6.5.2-php8.1-apache
    restart: always
    ports:
      - "9000:80"
    environment:
      WORDPRESS_DB_HOST: db:3306
      WORDPRESS_DB_USER: wpuser
      WORDPRESS_DB_PASSWORD: wppass
      WORDPRESS_DB_NAME: wordpress
    volumes:
      - ./wordpress:/var/www/html  
      - ./uploads.ini:/usr/local/etc/php/conf.d/uploads.ini
    depends_on:
      db:
        condition: service_healthy  

volumes:
  db_data:
  wp_data:

```

Create an `uploads.ini` file next to your `docker-compose.yml`:

```ini
; uploads.ini
file_uploads = On
memory_limit = 256M
upload_max_filesize = 128M
post_max_size = 128M
max_execution_time = 300
```

In the WordPress folder, update `wp-config.php` to read environment variables (example shown below). This file has been slightly modified to work with Docker by using environment variables when available.

```php
<?php
/**
 * The base configuration for WordPress
 */

// helper function to lookup env FILE then env, then fallback
if (!function_exists('getenv_docker')) {
    function getenv_docker($env, $default) {
        if ($fileEnv = getenv($env . '_FILE')) {
            return rtrim(file_get_contents($fileEnv), "\r\n");
        }
        else if (($val = getenv($env)) !== false) {
            return $val;
        }
        else {
            return $default;
        }
    }
}

define( 'DB_NAME', getenv_docker('WORDPRESS_DB_NAME', 'wordpress') );
define( 'DB_USER', getenv_docker('WORDPRESS_DB_USER', 'wordpress') );
define( 'DB_PASSWORD', getenv_docker('WORDPRESS_DB_PASSWORD', 'wordpress_password') );
define( 'DB_HOST', 'wordpress-db-1');
define( 'DB_CHARSET', 'utf8mb4' );
define( 'DB_COLLATE',  '' );

/* Authentication keys and salts (examples) */
define( 'AUTH_KEY', getenv_docker('WORDPRESS_AUTH_KEY', '...') );
// -- additional salts omitted for brevity in this example --

$table_prefix = getenv_docker('WORDPRESS_TABLE_PREFIX', 'wp_');

define( 'WP_DEBUG', !!getenv_docker('WORDPRESS_DEBUG', '') );

define('FS_METHOD', 'direct');

if ( ! defined( 'ABSPATH' ) ) {
    define( 'ABSPATH', __DIR__ . '/' );
}

require_once ABSPATH . 'wp-settings.php';
```

Start the environment with:

```powershell
sudo docker compose up -d --build
```

After the stack is up, visit http://localhost:9000 to complete the WordPress setup.

Once installation is finished, log in at http://localhost:9000/wp-admin using the account you created during setup.

![image.png]({{ site.url }}/assets/images/setup/image.png)

To install a plugin from the official WordPress plugin repository, download the plugin zip at:
`https://downloads.wordpress.org/plugin/{plugin-slug}.{version}.zip`.

For example, to download ninja-forms v3.11.0 use:
`https://downloads.wordpress.org/plugin/ninja-forms.3.11.0.zip`.

Note: Only free plugins available on the official WordPress.org repository can be downloaded this way.

In the admin panel: Plugins → Add New → Upload Plugin (zip file) to install, then activate the plugin.

![image.png]({{ site.url }}/assets/images/setup/image-1.png)

After activation, the plugin code will be available under:
`/wordpress/wp-content/plugins/{plugin-slug}`

![image.png]({{ site.url }}/assets/images/setup/image-2.png)

Vulnerabilities and plugin versions can be checked with WPScan.
